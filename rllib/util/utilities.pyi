from rllib.dataset.datatypes import Observation, Distribution, Array, Gaussian
from rllib.value_function import AbstractValueFunction
from typing import Callable, Tuple, List, Union
from torch import Tensor
import numpy as np
import torch

def get_backend(array: Array) -> Union[np, torch]: ...  # type: ignore

def mellow_max(values: Array, omega: float = 1.) -> Array: ...

def integrate(function: Callable, distribution: Distribution, num_samples: int = 1) -> Tensor: ...

def discount_cumsum(returns: Array, gamma: float = 1.0) -> Array: ...

def discount_sum(returns: Array, gamma: float=1.0) -> Array: ...

def mc_return(trajectory: List[Observation], gamma: float = 1.0,
              value_function: AbstractValueFunction=None): ...

def moving_average_filter(x: Array, y: Array, horizon: int) -> Array: ...

def separated_kl(p: Gaussian, q: Gaussian) -> Tuple[Tensor, Tensor]: ...